{
    "_comment": "DO NOT EDIT: FILE GENERATED AUTOMATICALLY BY PTERODACTYL PANEL - PTERODACTYL.IO",
    "meta": {
        "version": "PTDL_v2",
        "update_url": null
    },
    "exported_at": "2026-02-01T13:35:11-03:00",
    "name": "Arma Reforger",
    "author": "fabriciojuniorsilva@gmail.com",
    "description": "Experience authentic Cold War combat and join friends in the struggle for a sprawling, 51 km\u00c2\u00b2 mid-Atlantic island \u00e2\u20ac\u201d or take on the role of Game Master and create your very own scenarios for others to enjoy. Enhanced with A2S, RCON, Crossplay, and advanced operational settings.",
    "features": [
        "steam_disk_space",
        "pid_limit"
    ],
    "docker_images": {
        "cm2network\/steamcmd:latest": "cm2network\/steamcmd:latest",
        "fabriciojrsilva\/steamcmd-eggs:installer": "fabriciojrsilva\/steamcmd-eggs:installer"
    },
    "file_denylist": [],
    "startup": "cd \/home\/container && bash armareforger-server.sh",
    "config": {
        "files": "{\n    \"config.json\": {\n        \"parser\": \"json\",\n        \"find\": {\n            \"bindAddress\": \"0.0.0.0\",\n            \"bindPort\": \"{{server.build.default.port}}\",\n            \"publicAddress\": \"{{env.PUBLIC_IP}}\",\n            \"publicPort\": \"{{server.build.default.port}}\",\n            \"a2s.address\": \"{{env.PUBLIC_IP}}\",\n            \"a2s.port\": \"{{server.build.default.port}}\",\n            \"rcon.address\": \"{{env.PUBLIC_IP}}\",\n            \"rcon.port\": \"{{env.RCON_PORT}}\",\n            \"rcon.password\": \"{{env.RCON_PASSWORD}}\",\n            \"game.name\": \"{{env.SERVER_NAME}}\",\n            \"game.password\": \"{{env.SERVER_PASS}}\",\n            \"game.passwordAdmin\": \"{{env.ADMIN_PASS}}\",\n            \"game.scenarioId\": \"{{env.SCENARIO_ID}}\",\n            \"game.maxPlayers\": \"{{env.MAX_PLAYERS}}\",\n            \"game.visible\": \"{{env.VISIBLE}}\",\n            \"game.crossPlatform\": \"{{env.CROSS_PLATFORM}}\",\n            \"game.gameProperties.serverMaxViewDistance\": \"{{env.MAX_VIEW_DISTANCE}}\",\n            \"game.gameProperties.serverMinGrassDistance\": \"{{env.MIN_GRASS_DISTANCE}}\",\n            \"game.gameProperties.networkViewDistance\": \"{{env.NETWORK_VIEW_DISTANCE}}\",\n            \"game.gameProperties.disableThirdPerson\": \"{{env.DISABLE_THIRD}}\",\n            \"game.gameProperties.battlEye\": \"{{env.BATTLEYE}}\",\n            \"game.gameProperties.VONDisableUI\": \"{{env.VON_DISABLE_UI}}\",\n            \"game.gameProperties.VONDisableDirectSpeechUI\": \"{{env.VON_DISABLE_DIRECT_UI}}\",\n            \"game.gameProperties.VONCanTransmitCrossFaction\": \"{{env.VON_CROSS_FACTION}}\",\n            \"game.modsRequiredByDefault\": \"{{env.MODS_REQUIRED}}\",\n            \"operating.aiLimit\": \"{{env.AI_LIMIT}}\",\n            \"operating.disableAI\": \"{{env.DISABLE_AI}}\",\n            \"operating.disableServerShutdown\": \"{{env.DISABLE_SHUTDOWN}}\",\n            \"operating.joinQueue.maxSize\": \"{{env.QUEUE_MAX_SIZE}}\",\n            \"operating.playerSaveTime\": \"{{env.PLAYER_SAVE_TIME}}\",\n            \"operating.slotReservationTimeout\": \"{{env.SLOT_RESERVATION_TIMEOUT}}\"\n        }\n    }\n}",
        "startup": "{\n    \"done\": \"Starting RPL server\"\n}",
        "logs": "{}",
        "stop": "^C"
    },
    "scripts": {
        "installation": {
            "script": "#!\/bin\/bash\r\n# Arma Reforger Installation Script\r\n# Container: fabriciojrsilva\/steamcmd-eggs:installer (runs as ROOT during install)\r\n# Runtime: cm2network\/steamcmd:latest (runs as non-root steam user)\r\n#\r\n# Server Files: \/mnt\/server (mounted to \/home\/container at runtime)\r\n\r\n# Enable error reporting\r\nset -e  # Exit on any error\r\n\r\n##\r\n# Variables\r\n# SRCDS_APPID - 1874900 (Arma Reforger Dedicated Server)\r\n# INSTALL_LOG - DEBUG or INFO (default: INFO)\r\n##\r\n\r\n# Configure logging level\r\nINSTALL_LOG=\"${INSTALL_LOG:-INFO}\"\r\n\r\nif [ \"${INSTALL_LOG}\" = \"DEBUG\" ]; then\r\n    set -x  # Print each command before executing (verbose mode)\r\nfi\r\n\r\n# Logging functions\r\nlog_info() {\r\n    echo \"$1\"\r\n}\r\n\r\nlog_debug() {\r\n    if [ \"${INSTALL_LOG}\" = \"DEBUG\" ]; then\r\n        echo \"  [DEBUG] $1\"\r\n    fi\r\n}\r\n\r\nlog_step() {\r\n    echo \"[$1] $2\"\r\n}\r\n\r\nlog_substep() {\r\n    echo \"  -> $1\"\r\n}\r\n\r\nlog_error() {\r\n    echo \"==========================================\"\r\n    echo \"ERROR: $1\"\r\n    echo \"==========================================\"\r\n}\r\n\r\nlog_info \"==========================================\"\r\nlog_info \"Arma Reforger Server - Installation\"\r\nlog_info \"Logging Level: ${INSTALL_LOG}\"\r\nlog_info \"==========================================\"\r\n\r\nlog_debug \"Working directory: $(pwd)\"\r\nlog_debug \"User: $(whoami)\"\r\nlog_debug \"App ID: ${SRCDS_APPID}\"\r\n\r\ncd \/mnt\/server\r\n\r\n## Check if jq is available (should be in custom Docker image)\r\nlog_step \"1\/6\" \"Checking dependencies...\"\r\nif ! command -v jq &> \/dev\/null; then\r\n    log_substep \"jq not found, installing...\"\r\n    apt-get update > \/dev\/null 2>&1\r\n    apt-get install -y --no-install-recommends jq > \/dev\/null 2>&1\r\n    log_substep \"jq installed successfully\"\r\nelse\r\n    log_debug \"jq available: $(which jq)\"\r\nfi\r\n\r\n## Clean input variables\r\nlog_step \"2\/6\" \"Configuring installation parameters...\"\r\nSERVER_NAME=\"$(echo \"$SERVER_NAME\" | xargs)\"\r\nRCON_PASSWORD=\"$(echo \"$RCON_PASSWORD\" | xargs)\"\r\nADMIN_PASS=\"$(echo \"$ADMIN_PASS\" | xargs)\"\r\nlog_debug \"Server name: ${SERVER_NAME}\"\r\nlog_debug \"App ID: ${SRCDS_APPID}\"\r\n\r\n## Set default steam credentials\r\nif [ -z \"${STEAM_USER}\" ] || [ -z \"${STEAM_PASS}\" ]; then\r\n    log_substep \"Using anonymous Steam login\"\r\n    STEAM_USER=anonymous\r\n    STEAM_PASS=\"\"\r\n    STEAM_AUTH=\"\"\r\nelse\r\n    log_substep \"Using Steam account: ${STEAM_USER}\"\r\nfi\r\n\r\n## Create required directories\r\nlog_step \"3\/6\" \"Creating server directories...\"\r\nmkdir -p \/mnt\/server\/steamcmd\r\nmkdir -p \/mnt\/server\/steamapps\r\nmkdir -p \/mnt\/server\/profile\r\nmkdir -p \/mnt\/server\/tmp\r\nlog_debug \"Directories created: steamcmd, steamapps, profile, tmp\"\r\nlog_debug \"Setting HOME environment variable...\"\r\nexport HOME=\/mnt\/server\r\n\r\n## Install game files via SteamCMD (runs as ROOT with HOME=\/mnt\/server)\r\nlog_step \"4\/6\" \"Downloading Arma Reforger Server files (App ${SRCDS_APPID})...\"\r\nlog_debug \"Install directory: \/mnt\/server\"\r\nlog_debug \"SteamCMD directory: \/mnt\/server\/steamcmd\"\r\n\r\n## Test network connectivity before attempting download\r\nlog_debug \"Testing network connectivity...\"\r\n\r\n# Enhanced network diagnostics in DEBUG mode\r\nif [ \"${INSTALL_LOG}\" = \"DEBUG\" ]; then\r\n    log_debug \"Network interface information:\"\r\n    ip addr show 2>\/dev\/null || ifconfig 2>\/dev\/null || log_debug \"Cannot list network interfaces\"\r\n    log_debug \"Routing table:\"\r\n    ip route show 2>\/dev\/null || route -n 2>\/dev\/null || log_debug \"Cannot show routing table\"\r\n    log_debug \"DNS configuration:\"\r\n    cat \/etc\/resolv.conf 2>\/dev\/null || log_debug \"Cannot read DNS config\"\r\nfi\r\n\r\n# Test HTTP connectivity (more reliable than ICMP ping which is often blocked)\r\nif curl -s --connect-timeout 5 -o \/dev\/null -w \"%{http_code}\" http:\/\/www.google.com 2>\/dev\/null | grep -q \"200\\|301\\|302\"; then\r\n    log_debug \"Network connectivity OK (HTTP test successful)\"\r\nelif curl -s --connect-timeout 5 -o \/dev\/null -w \"%{http_code}\" http:\/\/cloudflare.com 2>\/dev\/null | grep -q \"200\\|301\\|302\"; then\r\n    log_debug \"Network connectivity OK (HTTP fallback successful)\"\r\nelse\r\n    log_error \"No network connectivity!\"\r\n    log_info \"The container cannot reach the internet via HTTP.\"\r\n    log_info \"\"\r\n    \r\n    # Additional diagnostics in DEBUG mode\r\n    if [ \"${INSTALL_LOG}\" = \"DEBUG\" ]; then\r\n        log_info \"Network Diagnostics:\"\r\n        log_info \"  Default Gateway: $(ip route show default 2>\/dev\/null | awk '{print $3}' || echo 'Unknown')\"\r\n        log_info \"  Container IP: $(hostname -i 2>\/dev\/null || echo 'Unknown')\"\r\n        log_info \"  DNS Servers: $(grep nameserver \/etc\/resolv.conf 2>\/dev\/null | awk '{print $2}' | tr '\\n' ' ' || echo 'Unknown')\"\r\n        log_info \"\"\r\n        log_info \"Testing connectivity methods:\"\r\n        log_info \"  HTTP test: $(curl -s --connect-timeout 3 -o \/dev\/null -w \"%{http_code}\" http:\/\/www.google.com 2>&1 || echo 'Failed')\"\r\n        log_info \"  DNS test: $(nslookup google.com 8.8.8.8 2>&1 | grep -A1 'Name:' | tail -1 || echo 'Failed')\"\r\n        log_info \"\"\r\n    fi\r\n    \r\n    log_info \"Troubleshooting steps:\"\r\n    log_info \"  1. Check Pterodactyl Wings network configuration (\/etc\/pterodactyl\/config.yml)\"\r\n    log_info \"  2. Verify Docker network: docker network ls\"\r\n    log_info \"  3. Check Docker daemon config: \/etc\/docker\/daemon.json\"\r\n    log_info \"     - Ensure 'iptables' is set to true\"\r\n    log_info \"  4. Test from host: docker run --rm alpine curl -s http:\/\/google.com\"\r\n    log_info \"  5. Check firewall rules and FORWARD policy: iptables -L FORWARD -n\"\r\n    log_info \"  6. Verify IP forwarding: cat \/proc\/sys\/net\/ipv4\/ip_forward (should be 1)\"\r\n    log_info \"\"\r\n    log_info \"Common causes:\"\r\n    log_info \"  - Docker daemon.json has 'iptables': false (prevents NAT)\"\r\n    log_info \"  - UFW FORWARD policy blocking container traffic\"\r\n    log_info \"  - Docker bridge network not configured correctly\"\r\n    log_info \"  - Host firewall blocking container traffic (check UFW, firewalld)\"\r\n    log_info \"  - DNS resolution problems (check \/etc\/resolv.conf in container)\"\r\n    log_info \"  - SELinux blocking container networking (check: getenforce)\"\r\n    log_info \"==========================================\"\r\n    exit 1\r\nfi\r\n\r\n## Test Steam connectivity\r\nlog_debug \"Testing Steam connectivity...\"\r\nif ping -c 1 steamcontent.com > \/dev\/null 2>&1 || ping -c 1 steamcdn-a.akamaihd.net > \/dev\/null 2>&1; then\r\n    log_debug \"Steam servers reachable\"\r\nelse\r\n    log_debug \"WARNING: Cannot ping Steam servers (may still work)\"\r\nfi\r\n\r\n## Download and extract SteamCMD\r\nlog_substep \"Downloading SteamCMD...\"\r\ncd \/tmp\r\ncurl -sSL -o steamcmd.tar.gz https:\/\/steamcdn-a.akamaihd.net\/client\/installer\/steamcmd_linux.tar.gz\r\ntar -xzvf steamcmd.tar.gz -C \/mnt\/server\/steamcmd\r\ncd \/mnt\/server\/steamcmd\r\nlog_debug \"SteamCMD extracted to \/mnt\/server\/steamcmd\"\r\n\r\n## Prepare SteamCMD execution environment\r\n# Set permissions for root to execute steamcmd\r\nchown -R root:root \/mnt\r\n\r\nlog_substep \"Starting SteamCMD download (this may take several minutes)...\"\r\n\r\n## SteamCMD download with retry logic (running as ROOT with HOME=\/mnt\/server)\r\nMAX_RETRIES=10\r\nRETRY_COUNT=0\r\nRETRY_DELAY=5  # Start with 5 seconds, increases with each attempt\r\n\r\nwhile [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\r\n    RETRY_COUNT=$((RETRY_COUNT + 1))\r\n    \r\n    if [ $RETRY_COUNT -gt 1 ]; then\r\n        log_substep \"Retry attempt $RETRY_COUNT of $MAX_RETRIES (waiting ${RETRY_DELAY}s before retry)...\"\r\n        sleep $RETRY_DELAY\r\n        # Increase delay for next retry (exponential backoff: 5s, 10s, 15s, 20s, etc.)\r\n        RETRY_DELAY=$((RETRY_DELAY + 5))\r\n    else\r\n        log_substep \"Attempt 1 of $MAX_RETRIES...\"\r\n    fi\r\n    \r\n    # Run SteamCMD as ROOT with HOME=\/mnt\/server (not as steam user)\r\n    # This ensures SteamCMD can properly manage files in \/mnt\/server\r\n    if timeout 1800 \/mnt\/server\/steamcmd\/steamcmd.sh +force_install_dir \/mnt\/server +login ${STEAM_USER} ${STEAM_PASS} ${STEAM_AUTH} +app_update ${SRCDS_APPID} ${INSTALL_FLAGS} validate +quit; then\r\n        log_substep \"Download completed successfully\"\r\n        RETRY_COUNT=$MAX_RETRIES  # Exit loop\r\n    else\r\n        STEAMCMD_EXIT_CODE=$?\r\n        \r\n        if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\r\n            if [ $STEAMCMD_EXIT_CODE -eq 124 ]; then\r\n                log_debug \"SteamCMD timeout (exit code 124) - retrying...\"\r\n            else\r\n                log_debug \"SteamCMD failed with exit code $STEAMCMD_EXIT_CODE - retrying...\"\r\n            fi\r\n        else\r\n            log_error \"SteamCMD download failed after $MAX_RETRIES attempts!\"\r\n            log_info \"Last exit code: $STEAMCMD_EXIT_CODE\"\r\n            log_info \"==========================================\"\r\n            log_info \"Troubleshooting:\"\r\n            log_info \"  - Check Steam service status: https:\/\/steamstatus.com\"\r\n            log_info \"  - Verify Steam credentials are correct\"\r\n            log_info \"  - Ensure Steam account owns Arma Reforger\"\r\n            log_info \"  - Check network connectivity: curl -s https:\/\/steampowered.com | head -n 5\"\r\n            log_info \"  - Review detailed logs above for specific errors\"\r\n            log_info \"==========================================\"\r\n            exit 1\r\n        fi\r\n    fi\r\ndone\r\n\r\n## Set up Steam SDK libraries (required for server binary)\r\nlog_substep \"Configuring Steam SDK libraries...\"\r\nmkdir -p \/mnt\/server\/.steam\/sdk32\r\nmkdir -p \/mnt\/server\/.steam\/sdk64\r\ncp -v \/mnt\/server\/steamcmd\/linux32\/steamclient.so \/mnt\/server\/.steam\/sdk32\/steamclient.so 2>\/dev\/null || log_debug \"32-bit library not found (may be OK)\"\r\ncp -v \/mnt\/server\/steamcmd\/linux64\/steamclient.so \/mnt\/server\/.steam\/sdk64\/steamclient.so 2>\/dev\/null || log_debug \"64-bit library not found (may be OK)\"\r\n\r\n## Verify installation\r\nlog_step \"5\/6\" \"Verifying installation...\"\r\n\r\nif [ ! -f \"\/mnt\/server\/ArmaReforgerServer\" ]; then\r\n    log_error \"Installation failed!\"\r\n    log_info \"The ArmaReforgerServer executable was not found.\"\r\n    log_info \"==========================================\"\r\n    if [ \"${INSTALL_LOG}\" = \"DEBUG\" ]; then\r\n        log_info \"Directory contents:\"\r\n        ls -lah \/mnt\/server\/ || log_info \"Cannot list directory\"\r\n        log_info \"==========================================\"\r\n    fi\r\n    log_info \"Possible causes:\"\r\n    log_info \"  - Invalid Steam credentials\"\r\n    log_info \"  - Network connectivity issues\"\r\n    log_info \"  - Insufficient disk space\"\r\n    log_info \"  - Steam service is down\"\r\n    log_info \"  - Wrong App ID (current: ${SRCDS_APPID})\"\r\n    log_info \"==========================================\"\r\n    exit 1\r\nfi\r\n\r\nlog_substep \"ArmaReforgerServer found ($(du -h \/mnt\/server\/ArmaReforgerServer | cut -f1))\"\r\n\r\n## Generate minimal config.json template (Pterodactyl will populate via config.files parser)\r\nlog_step \"6\/6\" \"Generating configuration template...\"\r\ncat > \/mnt\/server\/config.json << 'EOFCONFIG'\r\n{\r\n\t\"bindAddress\": \"0.0.0.0\",\r\n\t\"bindPort\": 2001,\r\n\t\"publicAddress\": \"0.0.0.0\",\r\n\t\"publicPort\": 2001,\r\n\t\"rcon\": {\r\n\t\t\"address\": \"0.0.0.0\",\r\n\t\t\"port\": 19998,\r\n\t\t\"password\": \"changeme\",\r\n\t\t\"permission\": \"admin\"\r\n\t},\r\n\t\"game\": {\r\n\t\t\"name\": \"Arma Reforger Server\",\r\n\t\t\"password\": \"\",\r\n\t\t\"passwordAdmin\": \"changeme\",\r\n\t\t\"admins\": [],\r\n\t\t\"scenarioId\": \"{ECC61978EDCC2B5A}Missions\/23_Campaign.conf\",\r\n\t\t\"maxPlayers\": 64,\r\n\t\t\"visible\": true,\r\n\t\t\"crossPlatform\": true,\r\n\t\t\"supportedPlatforms\": [\"PLATFORM_PC\", \"PLATFORM_XBL\", \"PLATFORM_PSN\"],\r\n\t\t\"gameProperties\": {\r\n\t\t\t\"serverMaxViewDistance\": 5000,\r\n\t\t\t\"serverMinGrassDistance\": 50,\r\n\t\t\t\"networkViewDistance\": 1500,\r\n\t\t\t\"disableThirdPerson\": false,\r\n\t\t\t\"fastValidation\": true,\r\n\t\t\t\"battlEye\": false,\r\n\t\t\t\"VONDisableUI\": false,\r\n\t\t\t\"VONDisableDirectSpeechUI\": false,\r\n\t\t\t\"VONCanTransmitCrossFaction\": false,\r\n\t\t\t\"missionHeader\": {}\r\n\t\t},\r\n\t\t\"modsRequiredByDefault\": false,\r\n\t\t\"mods\": []\r\n\t},\r\n\t\"operating\": {\r\n\t\t\"aiLimit\": -1,\r\n\t\t\"disableAI\": false,\r\n\t\t\"disableCrashReporter\": false,\r\n\t\t\"disableNavmeshStreaming\": [],\r\n\t\t\"disableServerShutdown\": true,\r\n\t\t\"joinQueue\": {\r\n\t\t\t\"maxSize\": 30\r\n\t\t},\r\n\t\t\"lobbyPlayerSynchronise\": true,\r\n\t\t\"playerSaveTime\": 120,\r\n\t\t\"slotReservationTimeout\": 60\r\n\t}\r\n}\r\nEOFCONFIG\r\n\r\nlog_substep \"Configuration template created (will be populated by panel)\"\r\nlog_debug \"Panel will update config.json via config.files parser on server start\"\r\n\r\n## Validate generated config.json\r\nlog_substep \"Validating JSON structure...\"\r\nif jq empty \/mnt\/server\/config.json 2>\/dev\/null; then\r\n    log_substep \"config.json is valid \u2713\"\r\nelse\r\n    log_error \"config.json validation failed!\"\r\n    log_info \"The generated configuration contains invalid JSON.\"\r\n    log_info \"==========================================\"\r\n    if [ \"${INSTALL_LOG}\" = \"DEBUG\" ]; then\r\n        log_info \"config.json content:\"\r\n        cat \/mnt\/server\/config.json || log_info \"Cannot read config.json\"\r\n        log_info \"==========================================\"\r\n        log_info \"Validation errors:\"\r\n        jq empty \/mnt\/server\/config.json 2>&1\r\n    fi\r\n    log_info \"==========================================\"\r\n    exit 1\r\nfi\r\n\r\n## Generate startup script with informative logging\r\necho \"  -> Generating startup script...\"\r\ncat > \/mnt\/server\/armareforger-server.sh << 'EOFSTARTUP'\r\n#!\/bin\/bash\r\n# Arma Reforger Server - Startup Script\r\n# This script displays server configuration and starts the Arma Reforger server\r\n\r\necho \"==========================================\"\r\necho \"Arma Reforger Dedicated Server - Starting\"\r\necho \"==========================================\"\r\necho \"\"\r\n\r\n# Diagnostic information\r\necho \"[Startup Diagnostics]\"\r\necho \"  Current User:       $(whoami)\"\r\necho \"  Working Directory:  $(pwd)\"\r\necho \"  Script Location:    $0\"\r\necho \"  Home Directory:     $HOME\"\r\necho \"\"\r\n\r\n# List files in current directory for verification\r\necho \"[Server Files in Working Directory]\"\r\nls -lh ArmaReforgerServer config.json armareforger-server.sh 2>\/dev\/null || echo \"  WARNING: Some expected files not found\"\r\necho \"\"\r\n\r\n# Display server configuration\r\necho \"[Server Configuration]\"\r\nif [ -f \"config.json\" ]; then\r\n    echo \"  Server Name:    $(jq -r '.game.name \/\/ \"N\/A\"' config.json)\"\r\n    echo \"  Scenario:       $(jq -r '.game.scenarioId \/\/ \"N\/A\"' config.json)\"\r\n    echo \"  Max Players:    $(jq -r '.game.maxPlayers \/\/ \"N\/A\"' config.json)\"\r\n    echo \"  Bind IP:        ${SERVER_IP:-0.0.0.0}\"\r\n    echo \"  Bind Port:      ${SERVER_PORT:-2001}\"\r\n    echo \"  A2S IP:         ${SERVER_IP:-0.0.0.0}\"\r\n    echo \"  A2S Port:       ${A2S_PORT:-17777}\"\r\n    echo \"  RCON Port:      $(jq -r '.rcon.port \/\/ \"N\/A\"' config.json)\"\r\n    echo \"  Crossplay:      $(jq -r '.game.crossPlatform \/\/ \"N\/A\"' config.json)\"\r\n    echo \"  BattlEye:       $(jq -r '.game.gameProperties.battlEye \/\/ \"N\/A\"' config.json)\"\r\n    echo \"  Visible:        $(jq -r '.game.visible \/\/ \"N\/A\"' config.json)\"\r\n    echo \"\"\r\nelse\r\n    echo \"  WARNING: config.json not found!\"\r\n    echo \"\"\r\nfi\r\n\r\necho \"[Network Tuning]\"\r\necho \"  RPL Timeout:       ${RPL_TIMEOUT:-30000}ms\"\r\necho \"  NDS Diameter:      ${NDS:-0}\"\r\necho \"  Network Resolution: ${NWK_RESOLUTION:-500}m\"\r\necho \"  Staggering Budget: ${STAGGERING_BUDGET:-100}\"\r\necho \"  Streaming Budget:  ${STREAMING_BUDGET:-10000}\"\r\necho \"  Streams Delta:     ${STREAMS_DELTA:-50}\"\r\necho \"\"\r\n\r\necho \"[Performance]\"\r\necho \"  Max FPS:        ${MAX_FPS:-unlimited}\"\r\necho \"  Log Interval:   ${LOG_INTERVAL}s\"\r\necho \"  Keep Logs:      ${KEEP_NUM_LOGS:-10}\"\r\necho \"\"\r\n\r\necho \"[Directories]\"\r\necho \"  Config:         .\/config.json\"\r\necho \"  Profile:        .\/profile\/\"\r\necho \"  Logs:           .\/profile\/console*.log\"\r\necho \"\"\r\n\r\necho \"==========================================\"\r\necho \"Validating and fixing config.json format...\"\r\n\r\n# Fix boolean values: convert string booleans to JSON booleans\r\nsed -i 's\/\"true\"\/true\/g; s\/\"false\"\/false\/g' config.json\r\n\r\n# Fix password fields: ensure they are always strings (not integers)\r\n# If a password field is empty or null, set it to empty string\r\njq '.game.password = (.game.password | tostring) | \r\n    .game.passwordAdmin = (.game.passwordAdmin | tostring) | \r\n    .rcon.password = (.rcon.password | tostring)' config.json > config.json.tmp && mv config.json.tmp config.json\r\n\r\necho \"Config.json validated and fixed\"\r\necho \"Starting server...\"\r\necho \"==========================================\"\r\necho \"\"\r\n\r\n# Start the Arma Reforger server with all parameters\r\n# Network parameters (bind IP\/port, A2S address\/port) are now configured via config.json\r\n# and automatically applied by Pterodactyl's config.files parser on startup\r\nexec .\/ArmaReforgerServer \\\r\n    -config .\/config.json \\\r\n    -profile .\/profile \\\r\n    -logStats $((${LOG_INTERVAL}*1000)) \\\r\n    -maxFPS ${MAX_FPS} \\\r\n    -rpl-timeout-ms ${RPL_TIMEOUT} \\\r\n    -nds ${NDS} \\\r\n    -nwkResolution ${NWK_RESOLUTION} \\\r\n    -staggeringBudget ${STAGGERING_BUDGET} \\\r\n    -streamingBudget ${STREAMING_BUDGET} \\\r\n    -streamsDelta ${STREAMS_DELTA} \\\r\n    -keepNumOfLogs ${KEEP_NUM_LOGS}\r\nEOFSTARTUP\r\n\r\nchmod +x \/mnt\/server\/armareforger-server.sh\r\nlog_substep \"Startup script created: armareforger-server.sh\"\r\n\r\n## Verify startup script was created\r\nif [ ! -f \"\/mnt\/server\/armareforger-server.sh\" ]; then\r\n    log_error \"Startup script generation failed!\"\r\n    log_info \"The armareforger-server.sh file was not created.\"\r\n    log_info \"===========================================\"\r\n    exit 1\r\nfi\r\n\r\nlog_debug \"Startup script verified and executable\"\r\nlog_debug \"Startup script size: $(du -h \/mnt\/server\/armareforger-server.sh | cut -f1)\"\r\n\r\n## Fix permissions: Set steam user as owner for runtime execution\r\nlog_debug \"Setting final permissions for steam user...\"\r\nchown -R steam:steam \/mnt\/server\r\n\r\nlog_info \"==========================================\"\r\nlog_info \"Installation completed successfully!\"\r\nlog_info \"==========================================\"\r\nlog_info \"Summary:\"\r\nlog_info \"  Server Binary: ArmaReforgerServer ($(du -h \/mnt\/server\/ArmaReforgerServer | cut -f1))\"\r\nlog_info \"  Startup Script: armareforger-server.sh\"\r\nlog_info \"  Config File: config.json (validated)\"\r\nlog_info \"  Server Name: ${SERVER_NAME}\"\r\nlog_info \"  Max Players: ${MAX_PLAYERS}\"\r\nlog_info \"  Install Size: $(du -sh \/mnt\/server 2>\/dev\/null | cut -f1 || echo 'N\/A')\"\r\nlog_info \"==========================================\"\r\n\r\nif [ \"${INSTALL_LOG}\" = \"DEBUG\" ]; then\r\n    log_debug \"Final directory listing:\"\r\n    ls -lah \/mnt\/server\/ | head -25\r\n    log_debug \"=========================================\"\r\n    log_debug \"Server binary location: $(which ArmaReforgerServer 2>\/dev\/null || echo 'Not in PATH')\"\r\n    log_debug \"Executable check: $(file \/mnt\/server\/ArmaReforgerServer 2>\/dev\/null)\"\r\n    log_debug \"=========================================\"\r\nfi\r\n",
            "container": "fabriciojrsilva\/steamcmd-eggs:installer",
            "entrypoint": "\/bin\/bash"
        }
    },
    "variables": [
        {
            "name": "Server Name",
            "description": "The name of your server as it appears in the server browser",
            "env_variable": "SERVER_NAME",
            "default_value": "Arma Reforger Server",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|max:255",
            "field_type": "text"
        },
        {
            "name": "[Advanced] Arma Reforger App ID",
            "description": "Steam Application ID for Arma Reforger Dedicated Server",
            "env_variable": "SRCDS_APPID",
            "default_value": "1874900",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|integer",
            "field_type": "text"
        },
        {
            "name": "[Advanced] Installation Log Level",
            "description": "Logging verbosity during server installation. INFO for normal output, DEBUG for detailed troubleshooting",
            "env_variable": "INSTALL_LOG",
            "default_value": "DEBUG",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:INFO,DEBUG",
            "field_type": "text"
        },
        {
            "name": "[Network] A2S Port",
            "description": "Port for Steam A2S query protocol (server browser)",
            "env_variable": "A2S_PORT",
            "default_value": "17772",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:1024,65535",
            "field_type": "text"
        },
        {
            "name": "[Network] Public IP Address",
            "description": "Public\/external IP address for server browser queries, A2S, and RCON. Set to your server's public IP (e.g., 191.96.81.87). Use 0.0.0.0 for localhost\/LAN only",
            "env_variable": "PUBLIC_IP",
            "default_value": "0.0.0.0",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|ip",
            "field_type": "text"
        },
        {
            "name": "[Network] RCON Port",
            "description": "Port for RCON remote administration",
            "env_variable": "RCON_PORT",
            "default_value": "19992",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:1024,65535",
            "field_type": "text"
        },
        {
            "name": "[Network] RCON Password",
            "description": "Password for RCON remote administration access",
            "env_variable": "RCON_PASSWORD",
            "default_value": "admin123",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|min:6|max:64",
            "field_type": "text"
        },
        {
            "name": "Server Password",
            "description": "Password required to join the server (leave empty for public access)",
            "env_variable": "SERVER_PASS",
            "default_value": "",
            "user_viewable": true,
            "user_editable": true,
            "rules": "nullable|string|max:50",
            "field_type": "text"
        },
        {
            "name": "Admin Password",
            "description": "Password for in-game admin access",
            "env_variable": "ADMIN_PASS",
            "default_value": "admin123",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|min:6|max:64",
            "field_type": "text"
        },
        {
            "name": "[Gameplay] Scenario ID",
            "description": "Mission\/scenario configuration path. Example: {ECC61978EDCC2B5A}Missions\/23_Campaign.conf",
            "env_variable": "SCENARIO_ID",
            "default_value": "{ECC61978EDCC2B5A}Missions\/23_Campaign.conf",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|max:255",
            "field_type": "text"
        },
        {
            "name": "[Gameplay] Max Players",
            "description": "Maximum number of players allowed on the server",
            "env_variable": "MAX_PLAYERS",
            "default_value": "128",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:1,256",
            "field_type": "text"
        },
        {
            "name": "[Gameplay] Server Visible",
            "description": "Show server in the server browser",
            "env_variable": "VISIBLE",
            "default_value": "true",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:true,false",
            "field_type": "text"
        },
        {
            "name": "[Gameplay] Crossplay Enabled",
            "description": "Enable crossplay between PC, Xbox, and PlayStation",
            "env_variable": "CROSS_PLATFORM",
            "default_value": "true",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:true,false",
            "field_type": "text"
        },
        {
            "name": "[Graphics] Max View Distance",
            "description": "Maximum rendering distance in meters (1600-10000)",
            "env_variable": "MAX_VIEW_DISTANCE",
            "default_value": "5000",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:1600,10000",
            "field_type": "text"
        },
        {
            "name": "[Graphics] Min Grass Distance",
            "description": "Minimum grass rendering distance in meters (0-150)",
            "env_variable": "MIN_GRASS_DISTANCE",
            "default_value": "150",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:0,150",
            "field_type": "text"
        },
        {
            "name": "[Graphics] Network View Distance",
            "description": "Network synchronization distance in meters (500-5000)",
            "env_variable": "NETWORK_VIEW_DISTANCE",
            "default_value": "1500",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:500,5000",
            "field_type": "text"
        },
        {
            "name": "[Gameplay] Disable Third Person",
            "description": "Disable third person camera view",
            "env_variable": "DISABLE_THIRD",
            "default_value": "true",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:true,false",
            "field_type": "text"
        },
        {
            "name": "[Gameplay] BattlEye Anti-Cheat",
            "description": "Enable BattlEye anti-cheat protection",
            "env_variable": "BATTLEYE",
            "default_value": "false",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:true,false",
            "field_type": "text"
        },
        {
            "name": "[Voice] Disable VON UI",
            "description": "Disable Voice-over-Network UI indicators",
            "env_variable": "VON_DISABLE_UI",
            "default_value": "false",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:true,false",
            "field_type": "text"
        },
        {
            "name": "[Voice] Disable Direct Speech UI",
            "description": "Disable direct speech UI indicators in VON",
            "env_variable": "VON_DISABLE_DIRECT_UI",
            "default_value": "false",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:true,false",
            "field_type": "text"
        },
        {
            "name": "[Voice] Cross-Faction VON",
            "description": "Allow voice transmission across enemy factions",
            "env_variable": "VON_CROSS_FACTION",
            "default_value": "false",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:true,false",
            "field_type": "text"
        },
        {
            "name": "[Gameplay] Mods Required by Default",
            "description": "Require players to have workshop mods to join",
            "env_variable": "MODS_REQUIRED",
            "default_value": "true",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:true,false",
            "field_type": "text"
        },
        {
            "name": "[Operating] AI Limit",
            "description": "Maximum number of AI entities (-1 for unlimited)",
            "env_variable": "AI_LIMIT",
            "default_value": "-1",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:-1,10000",
            "field_type": "text"
        },
        {
            "name": "[Operating] Disable AI",
            "description": "Completely disable AI on the server",
            "env_variable": "DISABLE_AI",
            "default_value": "true",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:true,false",
            "field_type": "text"
        },
        {
            "name": "[Operating] Disable Server Shutdown",
            "description": "Prevent automatic server shutdown when empty",
            "env_variable": "DISABLE_SHUTDOWN",
            "default_value": "true",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:true,false",
            "field_type": "text"
        },
        {
            "name": "[Operating] Queue Max Size",
            "description": "Maximum number of players in the join queue",
            "env_variable": "QUEUE_MAX_SIZE",
            "default_value": "25",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:0,100",
            "field_type": "text"
        },
        {
            "name": "[Operating] Player Save Interval",
            "description": "Player data save interval in seconds",
            "env_variable": "PLAYER_SAVE_TIME",
            "default_value": "120",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:30,600",
            "field_type": "text"
        },
        {
            "name": "[Operating] Slot Reservation Timeout",
            "description": "Timeout for reserved player slots in seconds",
            "env_variable": "SLOT_RESERVATION_TIMEOUT",
            "default_value": "60",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:10,300",
            "field_type": "text"
        },
        {
            "name": "[Advanced Startup] Max FPS",
            "description": "Maximum server FPS (0 for unlimited)",
            "env_variable": "MAX_FPS",
            "default_value": "60",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:0,240",
            "field_type": "text"
        },
        {
            "name": "[Advanced Startup] Log Stats Interval",
            "description": "Server statistics logging interval in seconds",
            "env_variable": "LOG_INTERVAL",
            "default_value": "60",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:10,600",
            "field_type": "text"
        },
        {
            "name": "[Advanced Startup] Keep Number of Logs",
            "description": "Number of console log files to retain",
            "env_variable": "KEEP_NUM_LOGS",
            "default_value": "10",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:1,100",
            "field_type": "text"
        },
        {
            "name": "[Advanced Startup] RPL Timeout (ms)",
            "description": "Replication layer timeout in milliseconds",
            "env_variable": "RPL_TIMEOUT",
            "default_value": "30000",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|integer|between:10000,120000",
            "field_type": "text"
        },
        {
            "name": "[Advanced Startup] NDS Diameter",
            "description": "Network Diameter Setting (0 for automatic)",
            "env_variable": "NDS",
            "default_value": "1",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|integer|between:0,1000",
            "field_type": "text"
        },
        {
            "name": "[Advanced Startup] Network Resolution (m)",
            "description": "Network synchronization resolution in meters",
            "env_variable": "NWK_RESOLUTION",
            "default_value": "250",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|integer|between:100,2000",
            "field_type": "text"
        },
        {
            "name": "[Advanced Startup] Staggering Budget",
            "description": "Network staggering budget for load balancing",
            "env_variable": "STAGGERING_BUDGET",
            "default_value": "2500",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|integer|between:10,10000",
            "field_type": "text"
        },
        {
            "name": "[Advanced Startup] Streaming Budget",
            "description": "Network streaming budget for performance tuning",
            "env_variable": "STREAMING_BUDGET",
            "default_value": "400",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|integer|between:100,100000",
            "field_type": "text"
        },
        {
            "name": "[Advanced Startup] Streams Delta",
            "description": "Network streams delta for replication management",
            "env_variable": "STREAMS_DELTA",
            "default_value": "250",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|integer|between:10,500",
            "field_type": "text"
        }
    ]
}